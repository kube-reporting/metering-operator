#
# Validate that the user con***REMOVED***gured authProxy ***REMOVED***elds correctly
#
- name: Validate the user-provided authProxy ***REMOVED***elds are not empty
  block:
  - name: Verify that authProxy.cookie.secretName is not empty
    assert:
      that:
        # note: we already do validation of the seed being non-empty
        - meteringcon***REMOVED***g_spec['reporting-operator'].spec.authProxy.cookie.secretName != ""
      msg: "spec.reporting-operator.spec.authProxy.cookie.secretName cannot be empty when createSecret is set to true"

  - name: Verify that authProxy.htpasswd.secretName is not empty
    assert:
      that:
        - meteringcon***REMOVED***g_spec['reporting-operator'].spec.authProxy.htpasswd.secretName != ""
      msg: "spec.reporting-operator.spec.authProxy.htpasswd.secretName cannot be empty when createSecret is set to true"

  - name: Verify that authProxy.authenticatedEmails was con***REMOVED***gured properly
    assert:
      that:
        - meteringcon***REMOVED***g_spec['reporting-operator'].spec.authProxy.authenticatedEmails.secretName != ""
        - meteringcon***REMOVED***g_spec['reporting-operator'].spec.authProxy.authenticatedEmails.data != ""
      msg: "spec.reporting-operator.spec.authProxy.authenticatedEmails: secretName and/or data key(s) cannot be empty when enabled and createSecret is set to true"
    when: meteringcon***REMOVED***g_spec['reporting-operator'].spec.authProxy.authenticatedEmails.enabled and meteringcon***REMOVED***g_spec['reporting-operator'].spec.authProxy.authenticatedEmails.createSecret
  when: not meteringcon***REMOVED***g_tls_enabled
