apiVersion: metering.openshift.io/v1
kind: MeteringCon***REMOVED***g
metadata:
  name: "operator-metering"
spec:
  permissions:
    # anyone in the "metering-admins" group can create, update, delete, etc any
    # metering.openshift.io resources in the namespace.
    # This also grants permissions to get query report results from the reporting REST API.
    meteringAdmins:
    - kind: Group
      name: metering-admins
    # Same as above except read only access and for the metering-viewers group.
    meteringViewers:
    - kind: Group
      name: metering-viewers
    # the default serviceaccount in the namespace "my-custom-ns" can:
    # create, update, delete, etc reports.
    # This also gives permissions query the results from the reporting REST API.
    reportingAdmins:
    - kind: ServiceAccount
      name: default
      namespace: my-custom-ns
    # anyone in the group reporting-readers can get, list, watch reports, and
    # query report results from the reporting REST API.
    reportingViewers:
    - kind: Group
      name: reporting-readers
    # anyone in the group cluster-admins can query report results
    # from the reporting REST API. So can the user bob-from-accounting.
    reportExporters:
    - kind: Group
      name: cluster-admins
    - kind: User
      name: bob-from-accounting

  reporting-operator:
    spec:
      route:
        # set to true to expose the Metering API as a route
        enabled: true

      authProxy:
        enabled: true
        # htpasswd.data can contain htpasswd ***REMOVED***le contents for allowing auth
        # using a static list of usernames and their password hashes.
        #
        # username is 'testuser' password is 'password123'
        # generated htpasswdData using: `htpasswd -nb -s testuser password123`
        # htpasswd:
        #   data: |
        #     testuser:{SHA}y/2sYAj5yrQIN4TL0YdPdmGNKpc=
        #
        # change REPLACEME to the output of your htpasswd command
        htpasswd:
          data: |
            REPLACEME

        # cookieSeed is used to protect the cookie created if accessing the API
        # via your browser.
        #
        # generate a 32 character random string using a command of your choice,
        # for example: `openssl rand -base64 32 | head -c32; echo`
        # seed: "RCFE+QpwGWL2bupP+wv4EIOnYlbaRmto"
        #
        # change REPLACEME to the output of your command
        cookie:
          createSecret: true
          seed: "REPLACEME"

        # Enables authenticating using a bearer token from a serviceAccount or user.
        # It must have have one of the following roles:
        # "report-exporter", "reporting-admin" or "reporting-viewer"
        # or it must have permissions granting "GET reports/export":
        # the export subresource of "reports".
        subjectAccessReview:
          enabled: true
        delegateURLs:
          enabled: true
