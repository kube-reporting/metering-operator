{{- $reportingValues :=  index .Values "openshift-reporting" -}}
{{- range $name, $body := $reportingValues.spec.defaultReportDataSources }}
---
apiVersion: metering.openshift.io/v1alpha1
kind: ReportDataSource
metadata:
  name: "{{ $name }}"
  labels:
    operator-metering: "true"
{{- block "extraMetadata" $ }}
{{- end }}
spec:
{{ toYaml $body.spec | indent 2 }}
{{- end }}

---
{{ if $reportingValues.spec.awsBillingReportDataSource.enabled -}}
apiVersion: metering.openshift.io/v1alpha1
kind: ReportDataSource
metadata:
  name: "aws-billing"
  labels:
    operator-metering: "true"
{{- block "extraMetadata" . }}
{{- end }}
spec:
  awsBilling:
    source:
      bucket: "{{ $reportingValues.spec.awsBillingReportDataSource.bucket }}"
      pre***REMOVED***x: "{{ $reportingValues.spec.awsBillingReportDataSource.pre***REMOVED***x }}"
      region: "{{ $reportingValues.spec.awsBillingReportDataSource.region }}"

---

apiVersion: metering.openshift.io/v1alpha1
kind: ReportDataSource
metadata:
  name: "aws-ec2-billing-data-raw-raw"
  labels:
    operator-metering: "true"
{{- block "extraMetadata" . }}
{{- end }}
spec:
  reportQueryView:
    queryName: "aws-ec2-billing-data-raw-raw"
{{- end }}
